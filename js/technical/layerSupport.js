var layers={};const decimalZero=new Decimal(0),decimalOne=new Decimal(1),decimalNaN=new Decimal(NaN),defaultGlow="#ff0000";function layerShown(e){return tmp[e].layerShown}var LAYERS=Object.keys(layers),hotkeys={},maxRow=0;function updateHotkeys(){hotkeys={};for(const e in layers){const a=layers[e].hotkeys;if(a)for(const l in a)hotkeys[a[l].key]=a[l],hotkeys[a[l].key].layer=e,hotkeys[a[l].key].id=l,void 0===a[l].unlocked&&(a[l].unlocked=!0)}}var ROW_LAYERS={},TREE_LAYERS={},OTHER_LAYERS={};function updateLayers(){LAYERS=Object.keys(layers),ROW_LAYERS={},TREE_LAYERS={},OTHER_LAYERS={};for(const e in layers)setupLayer(e);for(row in OTHER_LAYERS)for(layer in OTHER_LAYERS[row].sort(((e,a)=>e.position>a.position?1:-1)),OTHER_LAYERS[row])OTHER_LAYERS[row][layer]=OTHER_LAYERS[row][layer].layer;for(row in TREE_LAYERS)for(layer in TREE_LAYERS[row].sort(((e,a)=>e.position>a.position?1:-1)),TREE_LAYERS[row])TREE_LAYERS[row][layer]=TREE_LAYERS[row][layer].layer;let e=[];for(x=0;x<maxRow+1;x++)TREE_LAYERS[x]&&e.push(TREE_LAYERS[x]);TREE_LAYERS=e,updateHotkeys()}function setupLayer(e){if(layers[e].layer=e,layers[e].upgrades)for(thing in setRowCol(layers[e].upgrades),layers[e].upgrades)isPlainObject(layers[e].upgrades[thing])&&(layers[e].upgrades[thing].id=thing,layers[e].upgrades[thing].layer=e,void 0===layers[e].upgrades[thing].unlocked&&(layers[e].upgrades[thing].unlocked=!0));if(layers[e].milestones)for(thing in layers[e].milestones)isPlainObject(layers[e].milestones[thing])&&(layers[e].milestones[thing].id=thing,layers[e].milestones[thing].layer=e,void 0===layers[e].milestones[thing].unlocked&&(layers[e].milestones[thing].unlocked=!0));if(layers[e].achievements)for(thing in setRowCol(layers[e].achievements),layers[e].achievements)isPlainObject(layers[e].achievements[thing])&&(layers[e].achievements[thing].id=thing,layers[e].achievements[thing].layer=e,void 0===layers[e].achievements[thing].unlocked&&(layers[e].achievements[thing].unlocked=!0));if(layers[e].challenges)for(thing in setRowCol(layers[e].challenges),layers[e].challenges)isPlainObject(layers[e].challenges[thing])&&(layers[e].challenges[thing].id=thing,layers[e].challenges[thing].layer=e,void 0===layers[e].challenges[thing].unlocked&&(layers[e].challenges[thing].unlocked=!0),void 0===layers[e].challenges[thing].completionLimit?layers[e].challenges[thing].completionLimit=1:void 0===layers[e].challenges[thing].marked&&(layers[e].challenges[thing].marked=function(){return maxedChallenge(this.layer,this.id)}));if(layers[e].buyables)for(thing in layers[e].buyables.layer=e,setRowCol(layers[e].buyables),layers[e].buyables)isPlainObject(layers[e].buyables[thing])&&(layers[e].buyables[thing].id=thing,layers[e].buyables[thing].layer=e,void 0===layers[e].buyables[thing].unlocked&&(layers[e].buyables[thing].unlocked=!0),layers[e].buyables[thing].canBuy=function(){return canBuyBuyable(this.layer,this.id)},void 0===layers[e].buyables[thing].purchaseLimit&&(layers[e].buyables[thing].purchaseLimit=new Decimal(1/0)));if(layers[e].clickables)for(thing in layers[e].clickables.layer=e,setRowCol(layers[e].clickables),layers[e].clickables)isPlainObject(layers[e].clickables[thing])&&(layers[e].clickables[thing].id=thing,layers[e].clickables[thing].layer=e,void 0===layers[e].clickables[thing].unlocked&&(layers[e].clickables[thing].unlocked=!0));if(layers[e].bars)for(thing in layers[e].bars.layer=e,layers[e].bars)layers[e].bars[thing].id=thing,layers[e].bars[thing].layer=e,void 0===layers[e].bars[thing].unlocked&&(layers[e].bars[thing].unlocked=!0);if(layers[e].infoboxes)for(thing in layers[e].infoboxes)layers[e].infoboxes[thing].id=thing,layers[e].infoboxes[thing].layer=e,void 0===layers[e].infoboxes[thing].unlocked&&(layers[e].infoboxes[thing].unlocked=!0);if(layers[e].grid&&(layers[e].grid.layer=e,void 0===layers[e].grid.getUnlocked&&(layers[e].grid.getUnlocked=!0),void 0===layers[e].grid.getCanClick&&(layers[e].grid.getCanClick=!0)),layers[e].startData){const a=layers[e].startData();void 0!==a.best&&void 0===a.showBest&&(layers[e].showBest=!0),void 0!==a.total&&void 0===a.showTotal&&(layers[e].showTotal=!0)}layers[e].componentStyles||(layers[e].componentStyles={}),void 0===layers[e].symbol&&(layers[e].symbol=e[0].toUpperCase()+e.slice(1)),void 0===layers[e].unlockOrder&&(layers[e].unlockOrder=[]),void 0===layers[e].gainMult&&(layers[e].gainMult=decimalOne),void 0===layers[e].gainExp&&(layers[e].gainExp=decimalOne),void 0===layers[e].directMult&&(layers[e].directMult=decimalOne),void 0===layers[e].type&&(layers[e].type="none"),(void 0===layers[e].base||layers[e].base<1)&&(layers[e].base=2),void 0===layers[e].softcap&&(layers[e].softcap=new Decimal("e1e7")),void 0===layers[e].softcapPower&&(layers[e].softcapPower=new Decimal("0.5")),void 0===layers[e].displayRow&&(layers[e].displayRow=layers[e].row),void 0===layers[e].name&&(layers[e].name=e),void 0===layers[e].layerShown&&(layers[e].layerShown=!0),void 0===layers[e].glowColor&&(layers[e].glowColor="#ff0000");let a=layers[e].row,l=layers[e].displayRow;ROW_LAYERS[a]||(ROW_LAYERS[a]={}),TREE_LAYERS[l]||isNaN(l)||(TREE_LAYERS[l]=[]),!OTHER_LAYERS[l]&&isNaN(l)&&(OTHER_LAYERS[l]=[]),ROW_LAYERS[a][e]=e;let s=void 0!==layers[e].position?layers[e].position:e;!isNaN(l)||l<0?TREE_LAYERS[l].push({layer:e,position:s}):OTHER_LAYERS[l].push({layer:e,position:s}),maxRow<layers[e].displayRow&&(maxRow=layers[e].displayRow)}function addLayer(e,a,l=null){if(layers[e]=a,layers[e].isLayer=!0,null!==l){let a={};for(id in l)layer=l[id],a[layers[layer].name?layers[layer].name:layer]={embedLayer:layer,buttonStyle(){return tmp[this.embedLayer].nodeStyle?(style=tmp[this.embedLayer].nodeStyle,void 0===style["border-color"]&&(style["border-color"]=tmp[this.embedLayer].color),style):{"border-color":tmp[this.embedLayer].color}},unlocked(){return tmp[this.embedLayer].layerShown}};layers[e].tabFormat=a}}function addNode(e,a){layers[e]=a,layers[e].isLayer=!1}function readData(e,...a){return"function"==typeof e?e(...a):e}function setRowCol(e){if(e.rows&&e.cols)return;let a=0,l=0;for(const s in e)isNaN(s)||(a=Math.max(Math.floor(s/10),a),l=Math.max(s%10,l));e.rows=a,e.cols=l}function someLayerUnlocked(e){for(const a in ROW_LAYERS[e])if(player[a].unlocked)return!0;return!1}const UP=0,DOWN=1,LEFT=2,RIGHT=3;addLayer("info-tab",{tabFormat:["info-tab"],row:"otherside"}),addLayer("options-tab",{tabFormat:["options-tab"],row:"otherside"}),addLayer("changelog-tab",{tabFormat:[["raw-html",()=>modInfo.changelog]],row:"otherside"});
